<!--
  Generated template for the CalendarioPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header class="mui--bg-color-black-alpha-87 fg-light">
    <ion-navbar>
      <button ion-button menuToggle icon-only>
        <ion-icon name='menu'></ion-icon>
      </button>
      <ion-title style="color: white;">
        Calendario
      </ion-title>
    </ion-navbar>
  </ion-header>


<ion-content padding #content>
    <!-- refresh-->
    <ion-refresher (ionRefresh)="doRefresh($event)">
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>
    <!--
    <ion-label no-padding no-margin text-center style="font-style: italic;
          font-size: 0.9rem;">
      Deslize hacia abajo para actualizar
    </ion-label>
    -->
    <h1 text-center>{{viewTitle}}</h1>
  <ion-row>
      <ion-buttons end>
          <button ion-button small [disabled]="isToday" (click)="today()" class="mui--bg-color-amber-700 fg-black">Hoy</button>
          <!--
          <button ion-button small (click)="changeMode('month')">Mensual</button>
          <button ion-button small (click)="changeMode('week')">Semanal</button>
          <button ion-button small (click)="changeMode('day')">Diario</button>-->
          <!-- comentado 
          <button ion-button small (click)="loadEvents()">Cargar</button>-->
      </ion-buttons>
  </ion-row>
<calendar
  [monthviewEventDetailTemplate]="template" 
  [eventSource]="eventSource" 
  [calendarMode]="calendar.mode"
  [currentDate]="calendar.currentDate"  
  (onCurrentDateChanged)="onCurrentDateChanged($event)"
  (onEventSelected)="onEventSelected($event)" 
  (onTitleChanged)="onViewTitleChanged($event)"
  (onTimeSelected)="onTimeSelected($event)" step="30">
</calendar>
    <ng-template #template let-showEventDetail="showEventDetail" let-selectedDate="selectedDate" let-noEventsLabel="noEventsLabel">
        <!--
        <h5 class="noEvents" *ngIf="selectedDate.events.length == 0">No Events</h5>
        -->
        <h1 text-wrap style="padding-left: 2%;">{{timeSeleccionado | dateFormat: 'dddd DD'}}</h1>
        <ion-list>
          <ion-item class="noEvents" *ngIf="selectedDate.events.length == 0">
            <ion-avatar item-start>
              <ion-icon name="calendar" item-start style="font-size: 2.5em;"></ion-icon>
            </ion-avatar>
            <h1 text-wrap>No hay eventos</h1>
          </ion-item>
        
        </ion-list>
        <ion-list>
          
          <ion-item-sliding  *ngFor="let event of selectedDate.events">
            <ion-item (click)="onEventSelected(event)">
              <ion-avatar item-start>
                  <img [src]="event.Icono">
                  <!--
                <ion-icon  *ngIf="event.tipo == 1" name="calendar" item-start style="font-size: 2.5em;"></ion-icon>
                <ion-icon *ngIf="event.tipo != 1"  name="calendar" color="secondary" item-start style="font-size: 2.5em;"></ion-icon>
                  -->
              </ion-avatar>
                <!--<h1 text-wrap>{{event.startTime | dateFormat: 'dddd DD'}}</h1>-->
                <h2 text-wrap>{{event.title}}</h2>
                <ion-badge>{{event.startTime | dateFormat: 'DD-MM-YYYY HH:mm'}} - {{event.endTime | dateFormat: 'DD-MM-YYYY HH:mm'}}</ion-badge>
                <!-- para eliminar un evento
                <ion-icon name="trash" item-end style="font-size: 1.5em;"></ion-icon>-->
                <!--
                <ion-row *ngIf="event.tipo == 1">
                  <span style="font-size: 0.6em;font-style: italic;">Deslice a la izquierda para ver opciones</span>
                </ion-row>
              -->
            </ion-item>
            <ion-item-options side="right">
              <button ion-button color="danger" (click)="presentActionSheet(event)" *ngIf="permisos.EliminaCalendario == '1' && event.usuIdCreador == idUsuarioLogueado && event.tipo == 1">
                <ion-icon name="trash"></ion-icon>
                Borrar
              </button>
              <button ion-button (click)="presentModal(event)" *ngIf="permisos.ModificaCalendario == '1' && event.usuIdCreador == idUsuarioLogueado && event.tipo == 1">
                <ion-icon name="add"></ion-icon>
                Editar
              </button>
            </ion-item-options>
          </ion-item-sliding>
        </ion-list>
    </ng-template>
  

</ion-content>
<ion-fab bottom right *ngIf="permisos.CreaCalendario == 1" style ="bottom: 10%;">
  <button ion-fab  (click)="presentModal(null)" class="mui--bg-color-amber-700 fg-black">
    <ion-icon name="add"></ion-icon>
  </button>
</ion-fab>
